## 3.5 复位报文段

**讨论复位报文段产生的其中3种情况：**
### 3.5.1 访问不存在的端口

* 在kevin主机上执行以下命令:
``````shell
$ sudo tcpdump -nt -i ens33 port 54321 #监听发送自或来自54321端口的报文段
$ telnet 192.168.1.12 54321  #登录anonymous主机的54321端口
``````

* 查看输出:
``````shell
2.168.183.131.37580 > 192.168.1.12.54321: Flags [S], seq 120712580, win 64240, options [mss 1460,sackOK,TS val 436642116 ecr 0,nop,wscale 7], length 0

IP 192.168.1.12.54321 > 192.168.183.131.37580: Flags [R.], seq 1426343685, ack 120712581, win 64240, length 0
``````
由此可见,anonymouse针对kevin的连接请求发送了一个复位报文段,其窗口大小为0。由此可以预见,收到复位报文段的一端应该关闭或重新连接,而不能回应该报文段。

### 3.5.2 异常终止连接
TCP提供了一个异常终止连接的方法,即向对方发送一个复位报文段。一旦发送了复位报文段,发送端所有排队等待的数据都将被丢弃,应用程序可以通过socket的SO_LINGER选项来发送复位报文段。

### 3.5.3  处理半打开连接
考虑以下情况:服务器(或客户端)关闭或异常终止了连接,而对方未接收到结束报文段(例如网络故障),此时客户端(或服务器)还维持着原来的连接,此时就算服务器(或客户端)重启,也是去对于该连接的所有信息。我们称这种状态为半打开状态,若此时客户端(或服务器)对半打开状态的连接里写入数据,则对方回应一个复位报文段。



